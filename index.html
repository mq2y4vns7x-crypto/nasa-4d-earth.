<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NASA_ULTRA_4D</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three-globe@2.31.0/dist/three-globe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; color: #4af; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 1000;
        }
        #stream { font-size: clamp(20px, 5vw, 40px); font-weight: 900; letter-spacing: 2px; }
        #status { font-size: 12px; margin-top: 20px; color: #265; text-transform: uppercase; }
        .progress-container { width: 300px; height: 2px; background: #111; margin-top: 30px; }
        #progress-bar { width: 0%; height: 100%; background: #4af; box-shadow: 0 0 15px #4af; }
    </style>
</head>
<body>

    <div id="loader">
        <div id="stream">00000000000000</div>
        <div id="status">INIT_CORE_HANDSHAKE</div>
        <div class="progress-container"><div id="progress-bar"></div></div>
    </div>

    <div id="globeViz"></div>

    <script>
        // --- MODERN JS ENGINE ---
        const init = () => {
            const World = new ThreeGlobe()
                .showAtmosphere(true)
                .atmosphereColor('#4af')
                .atmosphereDayLightIntensity(1.5);

            const scene = new THREE.Scene();
            scene.add(World);
            scene.add(new THREE.AmbientLight(0xffffff, 1.5));

            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('globeViz').appendChild(renderer.domElement);

            const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 2000);
            camera.position.z = 400;

            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;

            // --- THE 100Hz LIVE DATA STREAM ---
            let cycle = 0;
            const max = 100;
            const streamEl = document.getElementById('stream');
            const statusEl = document.getElementById('status');
            const barEl = document.getElementById('progress-bar');

            const hyperLoop = setInterval(() => {
                cycle++;
                
                // MULTIPLIER: Generate a massive string of numbers that constantly updates
                // This creates the "00000" effect where every digit is live
                const rawData = Math.random().toString().split('.')[1] || "00000000000000";
                streamEl.innerText = rawData.substring(0, 14);
                
                barEl.style.width = `${cycle}%`;

                // COMBINE LAYERS AS WE GO
                if (cycle === 10) {
                    statusEl.innerText = "OPENING_GIBS_WMTS_ENDPOINT...";
                    World.globeTileEngineUrl((x, y, l) => 
                        `https://gibs.earthdata.nasa.gov/wmts/epsg4326/best/BlueMarble_ShadedRelief_Bathymetry/default/500m/${l}/${y}/${x}.jpg`
                    );
                }
                if (cycle === 40) {
                    statusEl.innerText = "OVERLAYING_TOPOLOGY_MESH...";
                    World.bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png');
                }
                if (cycle === 70) {
                    statusEl.innerText = "MERGING_BLUE_MARBLE_LOD...";
                    World.globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg');
                }

                if (cycle >= max) {
                    clearInterval(hyperLoop);
                    streamEl.innerText = "LINK_STABILIZED";
                    statusEl.innerText = "SUCCESS: 4D_RENDER_ACTIVE";
                    
                    setTimeout(() => {
                        document.getElementById('loader').style.opacity = '0';
                        setTimeout(() => document.getElementById('loader').remove(), 600);
                    }, 300);
                }
            }, 10); // Exactly 100 times per second

            const animate = () => {
                World.rotation.y += 0.001;
                controls.update();
                renderer.render(scene, camera);
                requestAnimationFrame(animate);
            };
            animate();
        };

        // Run the modern engine
        init();
    </script>
</body>
</html>
